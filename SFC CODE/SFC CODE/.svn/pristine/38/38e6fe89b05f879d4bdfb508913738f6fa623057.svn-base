
-- ===========================================================
-- Exec_InsertMESReceive,v1.0.0.0,2015/11/10,By Aimee Lu
-- ===========================================================
-- Check In TFS

USE [MESDB]
GO

SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

CREATE PROC [dbo].[Exec_InsertMESReceive]
	@RTVALUE VARCHAR(1) OUTPUT,
	@RTMSG NVARCHAR(128) OUTPUT,
	@USERNAME NVARCHAR(64)='',
	@FACTORYID NVARCHAR(64)='',
	@PONO NVARCHAR(32)='',
	@ITEM_NO NVARCHAR(1)='',
	@MATERIAL_NO NVARCHAR(32)='',
	@QTY FLOAT=0,
	@RECEIVENO NVARCHAR(64)='',
	@WAREHOUSEID NVARCHAR(32)='',
	@LOCATIONID NVARCHAR(32)=''
AS
BEGIN
	SET NOCOUNT ON;
	DECLARE @RECEIVE_ITEM_NO INT
	SELECT @RECEIVE_ITEM_NO=COUNT(1) + 1  FROM W_RECEIVE_LINES_T WHERE PONO=@PONO AND MATERIAL_NO=@MATERIAL_NO AND ITEM_NO=@ITEM_NO
	
	INSERT INTO W_RECEIVE_LINES_T(PONO, ITEM_NO, RECEIVENO, RECEIVE_ITEM_NO, MATERIAL_NO, QTY, RECEIVE_QTY, WAREHOUSE, LOCATION, 
                MATERIAL_BACHT, STATUS, CONVERSIONFLAG, CREATE_DATE)
	VALUES(@PONO,@ITEM_NO,@RECEIVENO,@RECEIVE_ITEM_NO,@MATERIAL_NO,@QTY,0,@WAREHOUSEID,@LOCATIONID,NULL,0,0,GETDATE())
	
	IF (@@ERROR>0)
	BEGIN
		SET @RTMSG=''
		SET @RTVALUE='0'
	END
	ELSE
	BEGIN
		SET @RTMSG=''
		SET @RTVALUE='1'
	END
END

GO


